/**
 * Minified by jsDelivr using Terser v5.3.5.
 * Original file: /npm/@domoinc/domo-phoenix@0.15.0/build/module/chart/chart.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var e,o=1,n=arguments.length;o<n;o++)for(var r in e=arguments[o])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},__importStar=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var o in t)Object.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e.default=t,e};Object.defineProperty(exports,"__esModule",{value:!0});var phoenix_data_type_1=require("../enums/phoenix-data-type"),phoenix_chart_config_1=require("../interfaces/phoenix-chart-config"),Phoenix=__importStar(require("../lib/phoenix")),map_utils_1=require("./map-utils"),DEFAULT_OPTIONS={height:400,width:500,animate:!0,colors:null,componentColors:{},backgroundColor:null,textColor:null,transparentBackground:!1},Chart=function(){function t(t,e,o){this._type=t,this._data=this.transformData(e.columns,e.rows),this._options=__assign({},DEFAULT_OPTIONS,o),this._instance=this._createInstance(),this._instance.setTransparentBackground(this._options.transparentBackground),this.setUsePhoenixHover(!0),this.canvas=this._instance.getCanvas()}return t.prototype.render=function(){this._instance.draw(null,!this._options.animate,!1)},t.prototype.resize=function(t,e){this._instance.resize(t,e)},t.prototype.update=function(t,e){e&&e.colors&&(this._options.colors=e.colors),e&&e.properties&&(this._options.properties=e.properties),this._data=this.transformData(t.columns,t.rows);var o=this._createConfigString(this._type,this._data,this._options);this._packet=o,this._instance.updateChartJson(o,!this._options.animate)},t.prototype.setChartProperties=function(t){this._options.properties=t,this.update(this._data)},t.prototype.resetColorPalette=function(){this._options.colors=null,this.update(this._data)},t.prototype.getPacket=function(){return this._packet},t.prototype.isChartPickerAvailable=function(){return this._instance.isChartPickerAvailable()},t.prototype.isChartPickerOpen=function(){return this._instance.isChartPickerOpen()},t.prototype.showChartPicker=function(){this._instance.showChartPicker()},t.prototype.hideChartPicker=function(){this._instance.hideChartPicker()},t.prototype.addEventListener=function(t,e){this._instance.addEventListener(t,e),"hover"===t&&this.setUsePhoenixHover(!1)},t.prototype.setUsePhoenixHover=function(t){this._instance.setUsePhoenixHover(t)},t.prototype.highlight=function(t){t&&t.length&&(this._instance.highlight(JSON.stringify(t))&&this._instance.draw())},t.prototype.transformData=function(t,e){var o={year:"Year",quarter:"CalendarQuarter",month:"CalendarMonth",week:"CalendarWeek",day:"Date"};if(t.forEach((function(t){null!=t.dateGrain&&(t.type="day"===t.dateGrain?phoenix_data_type_1.DATA_TYPE.DATE:phoenix_data_type_1.DATA_TYPE.STRING,t.grainColumnName=o[t.dateGrain])})),e&&e[0]&&e[0]instanceof Object&&!Array.isArray(e[0])){return{columns:t,rows:e.map((function(e){var o=[];return t&&t.forEach((function(t){return o.push(e[t.grainColumnName||t.name])})),o}))}}return{columns:t,rows:e}},t.prototype._createInstance=function(){var t=this._createConfigString(this._type,this._data,this._options),e=Phoenix.createPhoenixWithChartState(t,"{}",this._options.width,this._options.height,!0,0);return this._packet=t,e},t.prototype._createConfigString=function(t,e,o){var n=this._toPhoenixConfig(t,e,o);return JSON.stringify(n)},t.prototype._getMapDefinition=function(t){return console.error('Could not get definition for "'+t+'", this version of domoPhoenix does not include maps.'),null},t.prototype._toPhoenixConfig=function(t,e,o){var n=this,r={datasources:{default:{type:"ordered-column-list",data:{datasource:"default",metadata:e.columns.map((function(t){return{type:t.type}})),mappings:e.columns.map((function(t){return t.mapping})),columns:e.columns.map((function(t){return t.name})),formats:e.columns.map((function(t){return n._getFormat(t.format)})),rows:e.rows,numRows:e.rows.length,numColumns:e.columns.length}}},components:{graph:map_utils_1._isMap(t)?null:{type:"graph",badgetype:t,datasource:"default",columnFormats:{},overrides:o.properties||{}},map:map_utils_1._isMap(t)?{type:"map",badgetype:t,mapdef:"map",datasource:"default",columnFormats:{},overrides:o.properties||{}}:null},maps:map_utils_1._isMap(t)&&this._getMapDefinition(t),conditionalFormats:o.conditionalFormats,locale:"en-US",version:"6"};return map_utils_1._isMap(t)?delete r.components.graph:(delete r.maps,delete r.components.map),o.backgroundColor&&(r.backgroundColor=o.backgroundColor),o.textColor&&(r.textColor=o.textColor),o.colors&&(r.palette=this._createPalette(o.colors,o.componentColors)),r},t.prototype._getFormat=function(t){if(null!=t&&t.trim().length>0){var e={type:"default",format:"#",currency:"$",commas:!1,precision:0,percentMultiplied:!0,percent:!1};if(-1!=(t=t.trim()).indexOf("%"))e.type="percent",e.percent=!0,t=t.trim().substr(0,t.length-1);else{var o=t.charAt(0);"$"!=o&&"¥"!=o&&"€"!=o&&"£"!=o||(e.type="currency",e.currency=o)}-1!=t.indexOf(",")&&(e.commas=!0,e.format="###,###");var n=t.indexOf(".");return-1!=n&&(t=t.substr(n+1),e.precision=t.trim().length,e.format+="."+t),e}return null},t.prototype._createPalette=function(t,e){var o,n=function(t){return"#"===t.charAt(0)?t.substring(1):t},r=[{name:"CustomPalette",values:t.map((function(t){return n(t)})).slice()}],a=[{min:1,max:t.length,values:t.map((function(t,e){return[0,e]})).slice()}],i=[{colCount:t.length,values:t.map((function(t,e){return[0,e]})).slice()}],s=((o={})[phoenix_chart_config_1.ComponentColorName.BoxPlotFill]=[0,0],o[phoenix_chart_config_1.ComponentColorName.BoxPlotStroke]=[0,1],o[phoenix_chart_config_1.ComponentColorName.CandlestickDnRed]=[0,1],o[phoenix_chart_config_1.ComponentColorName.CandlestickUpGreen]=[0,0],o[phoenix_chart_config_1.ComponentColorName.CatScatterFill]=[0,0],o[phoenix_chart_config_1.ComponentColorName.CatScatterStroke]=[0,1],o[phoenix_chart_config_1.ComponentColorName.CompGaugeArrowGreen]=[0,0],o[phoenix_chart_config_1.ComponentColorName.CompGaugeArrowRed]=[0,1],o[phoenix_chart_config_1.ComponentColorName.CompGaugeDkGreen]=[0,0],o[phoenix_chart_config_1.ComponentColorName.CompGaugeDkRed]=[0,1],o[phoenix_chart_config_1.ComponentColorName.CompGaugeLtGreen]=[0,0],o[phoenix_chart_config_1.ComponentColorName.CompGaugeLtRed]=[0,1],o[phoenix_chart_config_1.ComponentColorName.FaceGaugeGray]=[0,3],o[phoenix_chart_config_1.ComponentColorName.FaceGaugeGreen]=[0,0],o[phoenix_chart_config_1.ComponentColorName.FaceGaugeRed]=[0,1],o[phoenix_chart_config_1.ComponentColorName.FaceGaugeYellow]=[0,2],o[phoenix_chart_config_1.ComponentColorName.FilledGaugeGreen]=[0,0],o[phoenix_chart_config_1.ComponentColorName.FilledGaugeRed]=[0,1],o[phoenix_chart_config_1.ComponentColorName.ProgressBar]=[0,0],o[phoenix_chart_config_1.ComponentColorName.WaterfallBlue]=[0,2],o[phoenix_chart_config_1.ComponentColorName.WaterfallGreen]=[0,0],o[phoenix_chart_config_1.ComponentColorName.WaterfallRed]=[0,1],o[phoenix_chart_config_1.ComponentColorName.WordCloudFirstOrange]=[0,0],o[phoenix_chart_config_1.ComponentColorName.WordCloudSecBlue]=[0,1],o);if(e){var p={name:"ColorMapRange",values:[]},c=r.push(p)-1;Object.keys(e).forEach((function(t){var o=p.values.push(n(e[t]))-1;s[t]=[c,o]}))}return{colorRanges:r,colorRules:a,gradients:i,nameColorMap:s}},t}();exports.Chart=Chart;
//# sourceMappingURL=/sm/5df1bfa78214e486148124e037743d5cb0f6492e96b9c4a81e468e2301c0b532.map